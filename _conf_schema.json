{
    "default_collection_name": {
        "description": "默认知识库集合名称",
        "type": "string",
        "default": "general"
    },
    "faiss_db_subpath": {
        "description": "Faiss 索引存储子路径 ",
        "type": "string",
        "default": "faiss_data",
        "hint": "(相对于持久化数据目录 'AstrBot/data/plugins_data/astrbot_plugin_knowledge_base/')"
    },
    "text_chunk_size": {
        "description": "文本分块大小 (字符数)",
        "type": "int",
        "default": 300
    },
    "text_chunk_overlap": {
        "description": "文本分块重叠大小 (字符数)",
        "type": "int",
        "default": 100
    },
    "search_top_k": {
        "description": "搜索时默认返回的结果数量",
        "type": "int",
        "default": 3
    },
    "auto_create_collection": {
        "description": "当指定的知识库集合不存在时，是否自动创建",
        "type": "bool",
        "default": true
    },
    "enable_llm_parser": {
        "description": "启用LLM解析复杂文件（如图片、复杂表格）",
        "type": "bool",
        "default": false,
        "hint": "启用后可解析图片中的文字等，会消耗LLM提供商Token（仅支持OpenAI兼容的提供商）"
    },
    "llm_parser_provider": {
        "description": "LLM解析器提供商ID",
        "type": "string",
        "default": "",
        "hint": "从AstrBot的LLM提供商中选择一个ID，为空时使用默认提供商"
    },
    "enable_kb_llm_enhancement": {
        "description": "使用知识库内容增强LLM请求",
        "type": "bool",
        "default": true,
        "hint": "在LLM对话中自动检索并注入相关的知识库内容"
    },
    "kb_llm_search_top_k": {
        "description": "LLM增强检索的文档数量",
        "type": "int",
        "default": 3,
        "hint": "为LLM对话检索的相关文档数量"
    },
    "kb_llm_insertion_method": {
        "description": "知识库内容插入方式",
        "type": "string",
        "default": "prepend_prompt",
        "options": [
            "prepend_prompt",
            "system_prompt"
        ],
        "hint": "prepend_prompt: 在用户消息前插入；system_prompt: 在系统消息中插入"
    },
    "kb_llm_min_similarity_score": {
        "description": "文档相关性最低分数",
        "type": "float",
        "default": 0.5,
        "hint": "只有相似度分数高于此值的文档才会被用于LLM增强"
    },
    "kb_llm_context_template": {
        "description": "知识库上下文模板",
        "type": "string",
        "default": "以下是可能相关的知识库内容：\n---\n{retrieved_contexts}\n---\n请根据以上信息回答我的问题。",
        "hint": "用于包装知识库上下文的模板，{retrieved_contexts}会被替换为检索到的内容"
    },
    "rerank_config": {
        "description": "重排序配置（API服务优先，轻量化处理）",
        "type": "object",
        "hint": "配置API重排序服务，实现零依赖启动和轻量化处理",
        "items": {
            "strategy": {
                "description": "重排序策略",
                "type": "string",
                "default": "auto",
                "options": [
                    "auto",
                    "api",
                    "simple"
                ],
                "hint": "auto: 自动选择最佳策略；api: 使用API重排序；simple: 使用简单重排序"
            },
            "api_provider": {
                "description": "API重排序服务提供商",
                "type": "string",
                "default": "cohere",
                "options": [
                    "cohere",
                    "jina",
                    "openai",
                    "custom"
                ],
                "hint": "仅当 strategy 为 'api' 或 'auto' 时有效"
            },
            "api_key": {
                "description": "API重排序服务密钥",
                "type": "string",
                "default": "",
                "hint": "对应提供商的API密钥，支持环境变量：COHERE_API_KEY, JINA_API_KEY, OPENAI_API_KEY"
            },
            "api_url": {
                "description": "自定义API重排序服务地址",
                "type": "string",
                "default": "",
                "hint": "自定义API服务地址，为空时使用默认地址"
            },
            "model_name": {
                "description": "重排序模型名称",
                "type": "string",
                "default": "",
                "hint": "使用的重排序模型名称，为空时使用默认模型"
            },
            "enable_cache": {
                "description": "启用API重排序缓存",
                "type": "bool",
                "default": true,
                "hint": "缓存API重排序结果以提高性能"
            },
            "cache_ttl": {
                "description": "API重排序缓存时间(秒)",
                "type": "int",
                "default": 3600,
                "hint": "缓存过期时间，单位秒"
            },
            "timeout": {
                "description": "API重排序超时时间(秒)",
                "type": "int",
                "default": 30,
                "hint": "API请求超时时间"
            },
            "max_retries": {
                "description": "API重排序最大重试次数",
                "type": "int",
                "default": 3,
                "hint": "API请求失败时的最大重试次数"
            }
        }
    }
}